# Final-Year-Project
毕业设计（初版），一个基于深度学习的智能跌倒检测系统。此跌倒检测系统支持上传图片、视频，以及在计算机上连接外部摄像头或打开内置摄像头。UI界面采用Gradio构建网页界面，简洁美观。此项目基于YOLOV8，用户需自行配置好YOLOV8的相关运行环境。
后续考虑将此项目打包成可以脱离 Python 环境运行的独立应用程序，以提高模型部署多样性。
# 1\. 开发工具

## - 编程语言和框架

  * **Python 3.8+** ：核心编程语言。
  * **PyTorch 1.12+** ：用于 YOLOv8 模型训练和推理的框架。
  * **OpenCV 4.5+** ：用于视频流处理和图像增强。
  * **Gradio** ：用于构建网页界面。

## - 辅助工具

  * **LabelImg** ：用于标注跌倒行为图像的数据标注工具。
  * **Git** ：用于版本控制，管理代码和数据集。
  * **Roboflow Universe数据集**

## - 集成开发环境（IDE）

  * **PyCharm** ：用于 Python 代码编写和调试。

# 2\. 软件环境

## - 操作系统

  * **Windows 11** ：用于用户界面开发和本地测试。

## - 深度学习依赖库

  * **Ultralytics YOLOv8** ：官方模型库。

## - 其他依赖包

  * **NumPy** ：用于数值计算。（暂未运用）
  * **Matplotlib** ：用于数据可视化。（暂未运用）
  * **SQLite** ：用于本地历史数据存储。（暂未运用）

# 3\. 硬件环境

## - 训练和开发设备

  * **CPU** ：英特尔® 酷睿™ I7 - 10875H 处理器 @ 2.30GHz（8 核）。
  * **GPU** ：NVIDIA RTX 2060（6GB 显存）。
  * **内存** ：16GB DDR4。
  * **存储** ：512 GB 固态硬盘（西部数据），用于存储数据集和代码。

    ## 模型性能评估(验证集)

以下是对模型在验证集上的性能评估结果的分析：

### 1. F1-Confidence Curve
- **图的含义**：
  - 横轴（X轴）是置信度（Confidence），纵轴（Y轴）是 F1 分数。
  - F1 分数是精确率（Precision）和召回率（Recall）的调和平均数，用于衡量模型的综合性能。
- **分析**：
  - 随着置信度的增加，F1 分数逐渐上升并趋近于 1，表明模型在高置信度下的预测性能非常好。
  - "摔倒中"（Falling）类别的 F1 分数在低置信度时略高于 "摔倒"（Fallen）类别，但在高置信度时两者的性能趋于一致。
  - 总体来看，模型在所有类别上的 F1 分数都很高，表明模型在验证集上的表现非常优秀。

![F1_curve](https://github.com/user-attachments/assets/c5a303e9-8fd7-4edf-8b9c-27dc97813114)

### 2. Precision-Confidence Curve
- **图的含义**：
  - 横轴（X轴）是置信度（Confidence），纵轴（Y轴）是精确率（Precision）。
  - 精确率表示模型预测为正的样本中实际为正的比例。
- **分析**：
  - 随着置信度的增加，精确率逐渐上升并趋近于 1，表明模型在高置信度下的预测结果非常可靠。
  - "摔倒中"（Falling）类别的精确率在低置信度时略高于 "摔倒"（Fallen）类别，但在高置信度时两者的性能趋于一致。
  - 总体来看，模型在所有类别上的精确率都很高，表明模型在验证集上的表现非常优秀。

![P_curve](https://github.com/user-attachments/assets/de68db76-27c0-49ba-8bbc-964594c0c789)

### 3. Precision-Recall Curve
- **图的含义**：
  - 横轴（X轴）是召回率（Recall），纵轴（Y轴）是精确率（Precision）。
  - 召回率表示实际为正的样本中被模型正确预测为正的比例。
  - 精确率-召回率曲线用于评估模型在不同阈值下的性能。
- **分析**：
  - 曲线几乎是一条直线，表明模型在所有召回率水平下的精确率都非常高。
  - "摔倒"（Fallen）和 "摔倒中"（Falling）类别的曲线几乎重合，表明这两个类别的性能非常接近。
  - 总体来看，模型在验证集上的精确率和召回率都非常高，表明模型在检测摔倒行为方面表现非常优秀。

![PR_curve](https://github.com/user-attachments/assets/208b1405-2f3a-4331-86e7-13c34af66771)

### 4. Recall-Confidence Curve
- **图的含义**：
  - 横轴（X轴）是置信度（Confidence），纵轴（Y轴）是召回率（Recall）。
  - 召回率表示实际为正的样本中被模型正确预测为正的比例。
- **分析**：
  - 曲线几乎是一条直线，表明模型在所有置信度水平下的召回率都非常高。
  - "摔倒"（Fallen）和 "摔倒中"（Falling）类别的曲线几乎重合，表明这两个类别的性能非常接近。
  - 总体来看，模型在验证集上的召回率非常高，表明模型在检测摔倒行为方面表现非常优秀。

![R_curve](https://github.com/user-attachments/assets/9def4210-284c-4e6c-af08-b25598886cd4)

### 综合评价
1. **模型性能优秀**：
   - 从 F1-Confidence 曲线和 Precision-Confidence 曲线来看，模型在高置信度下的预测性能非常好，F1 分数和精确率都趋近于 1。
   - 从 Precision-Recall 曲线来看，模型在所有召回率水平下的精确率都非常高，表明模型在检测摔倒行为方面表现非常优秀。
   - 从 Recall-Confidence 曲线来看，模型在所有置信度水平下的召回率都非常高，表明模型在检测摔倒行为方面表现非常优秀。

2. **类别平衡**：
   - "摔倒"（Fallen）和 "摔倒中"（Falling）类别的性能非常接近，表明模型在处理这两个类别时没有明显的偏差。

3. **建议**：
   - 由于模型在验证集上的表现非常优秀，可以考虑在实际应用中使用该模型。
   - 如果需要进一步优化，可以尝试调整置信度阈值，以在精确率和召回率之间找到最佳平衡点。


 ## 模型性能评估（测试集）

以下是对模型在测试集上的性能评估结果的分析：

### 1. F1-Confidence Curve
- **图的含义**：
  - 横轴（X轴）是置信度（Confidence），纵轴（Y轴）是 F1 分数。
  - F1 分数是精确率（Precision）和召回率（Recall）的调和平均数，用于衡量模型的综合性能。
- **分析**：
  - 随着置信度的增加，F1 分数先上升后下降，表明模型在中等置信度区间（约0.3-0.5）的预测性能最佳。
  - "摔倒中"（Falling）类别的 F1 分数在大部分置信度区间内高于 "摔倒"（Fallen）类别，表明模型对 "摔倒中" 类别的预测性能相对更好。
  - 总体来看，模型在所有类别上的 F1 分数在中等置信度区间内较高，但在高置信度区间下降明显，表明模型在高置信度下的预测性能不稳定。

![F1_curve](https://github.com/user-attachments/assets/52abc1db-ef6f-44aa-aa4c-0fed285d8cd6)

### 2. Precision-Confidence Curve
- **图的含义**：
  - 横轴（X轴）是置信度（Confidence），纵轴（Y轴）是精确率（Precision）。
  - 精确率表示模型预测为正的样本中实际为正的比例。
- **分析**：
  - 随着置信度的增加，精确率逐渐上升并趋近于 1，表明模型在高置信度下的预测结果非常可靠。
  - "摔倒中"（Falling）类别的精确率在大部分置信度区间内高于 "摔倒"（Fallen）类别，表明模型对 "摔倒中" 类别的预测性能相对更好。
  - 总体来看，模型在所有类别上的精确率在高置信度区间内都非常高，表明模型在高置信度下的预测性能非常优秀。

![P_curve](https://github.com/user-attachments/assets/deb589bd-a972-4856-ba96-4d30d2f0da7d)

### 3. Precision-Recall Curve
- **图的含义**：
  - 横轴（X轴）是召回率（Recall），纵轴（Y轴）是精确率（Precision）。
  - 召回率表示实际为正的样本中被模型正确预测为正的比例。
  - 精确率-召回率曲线用于评估模型在不同阈值下的性能。
- **分析**：
  - 曲线在高召回率区间有明显的下降趋势，表明模型在高召回率下的精确率较低。
  - "摔倒中"（Falling）类别的曲线在大部分召回率区间内高于 "摔倒"（Fallen）类别，表明模型对 "摔倒中" 类别的预测性能相对更好。
  - 总体来看，模型在测试集上的精确率和召回率表现良好，但存在一定的权衡，需要在实际应用中根据需求调整阈值。

![PR_curve](https://github.com/user-attachments/assets/6209ad59-47a3-461b-b829-94e67e309fc0)

### 4. Recall-Confidence Curve
- **图的含义**：
  - 横轴（X轴）是置信度（Confidence），纵轴（Y轴）是召回率（Recall）。
  - 召回率表示实际为正的样本中被模型正确预测为正的比例。
- **分析**：
  - 随着置信度的增加，召回率逐渐下降，表明模型在高置信度下的召回率较低。
  - "摔倒中"（Falling）类别的召回率在大部分置信度区间内高于 "摔倒"（Fallen）类别，表明模型对 "摔倒中" 类别的召回性能相对更好。
  - 总体来看，模型在所有类别上的召回率在低置信度区间内较高，但在高置信度区间下降明显，表明模型在高置信度下的召回性能不稳定。

  ![R_curve](https://github.com/user-attachments/assets/b2c9837a-dc36-4b0b-88c0-a8370d3f66d8)

### 综合评价
1. **模型性能良好但有改进空间**：
   - 从 F1-Confidence 曲线和 Precision-Confidence 曲线来看，模型在中等置信度区间（约0.3-0.5）的预测性能最佳，但在高置信度区间性能下降明显。
   - 从 Precision-Recall 曲线来看，模型在高召回率下的精确率较低，表明模型在高召回率下的预测结果不够可靠。
   - 从 Recall-Confidence 曲线来看，模型在高置信度下的召回率较低，表明模型在高置信度下的召回性能不稳定。

2. **类别性能差异**：
   - "摔倒中"（Falling）类别的性能在大部分区间内优于 "摔倒"（Fallen）类别，表明模型对 "摔倒中" 类别的预测性能相对更好。

总体来说，这些图表表明模型性能良好，适当改进后可用于工业级检测。

### 后续计划
目前这只是一个初步版本，我后续打算接入历史回溯功能以方便查询跌倒次数的历史详情，并通过云平台发送短信到指定手机号以警示相关人员，完善跌倒检测系统的服务。

### 硬件环境

由于训练模型的条件有限，本项目的训练和开发是在以下硬件配置下完成的：

- **CPU**: Intel® Core™ i7-10875H CPU @ 2.30GHz（8 核）
- **GPU**: NVIDIA RTX 2060（6GB 显存）
- **内存**: 16GB DDR4
- **存储**: 512 GB 固态硬盘（西部数据）（用于存储数据集与代码）

导致模型的精度不能到达非常高的水平，感谢您的理解和支持！




